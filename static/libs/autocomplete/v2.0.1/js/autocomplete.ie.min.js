/*!
* @name autocomplete
* @version 2.0.1
* @author Grzegorz Tomicki
* @link https://github.com/tomickigrzegorz/autocomplete
* @license MIT
*/
var Autocomplete=function(){"use strict";const t=(t,s)=>{for(let i in s)"addClass"===i?e(t,"add",s[i]):"removeClass"===i?e(t,"remove",s[i]):t.setAttribute(i,s[i])},s=t=>(t.firstElementChild||t).textContent.trim(),i=(t,s)=>{t.scrollTop=t.offsetTop-s.offsetHeight},h=function(t,s){void 0===t&&(t=!1),t&&(e(t,"remove","hidden"),r(t,"click",s))},e=(t,s,i)=>t.classList[s](i),a=(s,i)=>{t(s,{"aria-activedescendant":i||""})},n=(t,s,i,h)=>{const e=h.previousSibling,a=e?e.offsetHeight:0;if("0"==t.getAttribute("aria-posinset")&&(h.scrollTop=t.offsetTop-((t,s)=>{const i=document.querySelectorAll("#"+t+" > li:not(."+s+")");let h=0;return[].slice.call(i).map((t=>h+=t.offsetHeight)),h})(s,i)),t.offsetTop-a<h.scrollTop)h.scrollTop=t.offsetTop-a;else{const s=t.offsetTop+t.offsetHeight-a;s>h.scrollTop+h.offsetHeight&&(h.scrollTop=s-h.offsetHeight)}},l=t=>document.createElement(t),o=t=>document.querySelector(t),r=(t,s,i)=>{t.addEventListener(s,i)},c=(t,s,i)=>{t.removeEventListener(s,i)},d=t=>({"aria-owns":t,"aria-expanded":"false","aria-autocomplete":"list",role:"combobox",removeClass:"auto-expanded"}),u=27,m=13,p=38,v=40,b=9;return class{constructor(f,x){let{delay:y=500,clearButton:C=!0,clearButtonOnInitial:k=!1,howManyCharacters:g=1,selectFirst:w=!1,insertToInput:j=!1,showAllValues:I=!1,cache:S=!1,disableCloseOnSelect:V=!1,preventScrollUp:O=!1,removeResultsWhenInputIsEmpty:R=!1,regex:A={expression:/[|\\{}()[\]^$+*?]/g,replacement:"\\$&"},classGroup:$,classPreventClosing:B,classPrefix:P,ariaLabelClear:T,onSearch:E,onResults:G=(()=>{}),onSubmit:J=(()=>{}),onOpened:N=(()=>{}),onReset:q=(()=>{}),onRender:z=(()=>{}),onClose:F=(()=>{}),noResults:L=(()=>{}),onSelectedItem:M=(()=>{})}=x;var U;this.t=()=>{this.i();const s=d(this.h);var i,e,a,n,l;t(this.l,s),i=this.l,e=this.o,a=this.h,n=this.u,l=this.m,t(e,{id:a,tabIndex:"0",role:"listbox"}),t(n,{addClass:l+"-results-wrapper"}),n.insertAdjacentElement("beforeend",e),i.parentNode.insertBefore(n,i.nextSibling),r(this.l,"input",this.p),this.v&&r(this.l,"click",this.p),this.C({element:this.l,results:this.o}),this.k&&h(this.j,this.destroy)},this.I=(t,s)=>{this.S&&("update"===t?this.l.setAttribute(this.V,s.value):"remove"===t?this.l.removeAttribute(this.V):this.l.value=this.l.getAttribute(this.V))},this.p=t=>{let{target:s,type:i}=t;if("true"===this.l.getAttribute("aria-expanded")&&"click"===i)return;const h=s.value.replace(this.O.expression,this.O.replacement);this.I("update",s);const e=this.v?0:this.R;clearTimeout(this.A),this.A=setTimeout((()=>{this.$&&0===s.value.length?this.destroy():this.B(h.trim())}),e)},this.P=()=>{var s;e(this.u,"remove",this.T);const i=d(this.h),h=this.G?i:{...i,"aria-activedescendant":""};t(this.l,h),this.G||(this.J(o("."+this.N)),this.q=this.F?0:-1),(0==(null==(s=this.L)?void 0:s.length)&&!this.M||this.v)&&(this.o.textContent=""),this.U()},this.B=t=>{this.W=t,this.D(!0),h(this.j,this.destroy),0==t.length&&this.H&&e(this.j,"add","hidden"),this.K>t.length&&!this.v?this.D():this.X({currentValue:t,element:this.l}).then((s=>{const i=this.l.value.length,h=s.length;this.L=Array.isArray(s)?s:JSON.parse(JSON.stringify(s)),this.D(),this.Y(),0==h&&0==i&&e(this.j,"add","hidden"),0==h&&i?(e(this.l,"remove","auto-expanded"),this.P(),this.Z({element:this.l,currentValue:t,template:this._}),this.tt()):(h>0||(t=>t&&"object"==typeof t&&t.constructor===Object)(s))&&(this.q=this.F?0:-1,this._(),this.tt())})).catch((()=>{this.D(),this.P()}))},this.D=t=>this.l.parentNode.classList[t?"add":"remove"](this.st),this.Y=()=>e(this.l,"remove",this.it),this.tt=()=>{r(this.l,"keydown",this.ht),r(this.l,"click",this.et),r(document,"click",this.nt),["mousemove","click"].map((t=>{r(this.o,t,this.lt)}))},this._=s=>{t(this.l,{"aria-expanded":"true",addClass:this.m+"-expanded"}),this.o.textContent="";const h=0===this.L.length?this.ot({currentValue:this.W,matches:0,template:s}):this.ot({currentValue:this.W,matches:this.L,classGroup:this.rt});this.o.insertAdjacentHTML("afterbegin",h),e(this.u,"add",this.T);const a=this.rt?":not(."+this.rt+")":"";this.ct=document.querySelectorAll("#"+this.h+" > li"+a),(s=>{for(let i=0;i<s.length;i++)t(s[i],{role:"option",tabindex:"-1","aria-selected":"false","aria-setsize":s.length,"aria-posinset":i+1})})(this.ct),this.dt({type:"results",element:this.l,results:this.o}),this.ut(),i(this.o,this.u)},this.nt=t=>{let{target:s}=t,i=null;(s.closest("ul")&&this.vt||s.closest("."+this.bt))&&(i=!0),s.id===this.ft||i||this.P()},this.ut=()=>{if(this.J(o("."+this.N)),!this.F)return;const{firstElementChild:s}=this.o,i=this.rt&&this.L.length>0&&this.F?s.nextElementSibling:s;this.xt({index:this.q,element:this.l,object:this.L[this.q]}),t(i,{id:this.yt+"-0",addClass:this.N,"aria-selected":"true"}),a(this.l,this.yt+"-0")},this.et=()=>{if(this.o.textContent.length>0&&!e(this.u,"contains",this.T)){if(t(this.l,{"aria-expanded":"true",addClass:this.m+"-expanded"}),e(this.u,"add",this.T),this.G||(i(this.o,this.u),this.ut()),this.dt({type:"showItems",element:this.l,results:this.o}),!this.S)return;this.I("update",this.l)}},this.lt=t=>{t.preventDefault();const{target:s,type:i}=t,h=s.closest("li"),a=null==h?void 0:h.hasAttribute("role"),n=this.N,l=o("."+n);h&&a&&!s.closest("."+this.bt)&&("click"===i&&this.Ct(h),"mousemove"!==i||e(h,"contains",n)||(this.J(l),this.kt(h),this.q=this.gt(h),this.xt({index:this.q,element:this.l,object:this.L[this.q]})))},this.Ct=t=>{t&&0!==this.L.length?(this.H&&e(this.j,"remove","hidden"),this.l.value=s(t),this.wt({index:this.q,element:this.l,object:this.L[this.q],results:this.o}),this.vt||(this.G||this.J(t),this.P()),this.I("remove")):!this.vt&&this.P()},this.gt=t=>Array.prototype.indexOf.call(this.ct,t),this.ht=t=>{const{keyCode:i}=t,h=e(this.u,"contains",this.T),n=this.L.length+1;switch(this.jt=o("."+this.N),i){case p:case v:if(t.preventDefault(),n<=1&&this.F||!h)return;if(i===p?(this.q<0&&(this.q=n-1),this.q-=1):(this.q+=1,this.q>=n&&(this.q=0)),this.J(this.jt),this.q>=0&&this.q<n-1){const t=this.ct[this.q];this.M&&h&&(this.l.value=s(t)),this.xt({index:this.q,element:this.l,object:this.L[this.q]}),this.kt(t)}else this.I(),a(this.l),this.xt({index:null,element:this.l,object:null});break;case m:t.preventDefault(),this.Ct(this.jt);break;case b:case u:t.stopPropagation(),this.P()}},this.kt=s=>{const i=this.yt+"-"+this.gt(s);t(s,{id:i,"aria-selected":"true",addClass:this.N}),a(this.l,i),n(s,this.h,this.rt,this.o)},this.J=s=>{s&&t(s,{id:"",removeClass:this.N,"aria-selected":"false"})},this.i=()=>{this.H&&(t(this.j,{class:this.m+"-clear hidden",type:"button",title:this.It,"aria-label":this.It}),this.l.insertAdjacentElement("afterend",this.j))},this.rerender=t=>{const s=null!=t&&t.trim()?t.trim():this.l.value;null!=t&&t.trim()&&(this.l.value=t.trim(),this.I("update",this.l));const i=s.replace(this.O.expression,this.O.replacement);this.B(i.trim())},this.destroy=()=>{this.H&&e(this.j,"add","hidden"),this.l.value="",this.l.focus(),this.o.textContent="",this.P(),this.Y(),this.St(this.l),this.D(),c(this.l,"keydown",this.ht),c(this.l,"click",this.et),c(document,"click",this.nt)},this.ft=f,this.l=document.getElementById(f),this.X=(U=E,Boolean(U&&"function"==typeof U.then)?E:t=>{let{currentValue:s,element:i}=t;return Promise.resolve(E({currentValue:s,element:i}))}),this.ot=G,this.C=z,this.wt=J,this.xt=M,this.dt=N,this.St=q,this.Z=L,this.U=F,this.R=y,this.K=g,this.H=C,this.k=k,this.F=w,this.M=j,this.v=I,this.rt=$,this.bt=B,this.It=T||"clear the search query",this.m=P?P+"-auto":"auto",this.vt=V,this.G=O,this.$=R,this.S=S,this.A=null,this.h=this.m+"-"+this.ft+"-results",this.V="data-cache-auto-"+this.ft,this.st=this.m+"-is-loading",this.T=this.m+"-is-active",this.N=this.m+"-selected",this.yt=this.m+"-selected-option",this.it=this.m+"-error",this.u=l("div"),this.o=l("ul"),this.j=l("button"),this.O=A,this.Vt={expression:/[|\\{}()[\]^$+*?]/g,replacement:"\\$&"},this.O.replacement||(this.O.replacement=this.Vt.replacement),this.O.expression||(this.O.expression=this.Vt.expression),this.t()}}}();
